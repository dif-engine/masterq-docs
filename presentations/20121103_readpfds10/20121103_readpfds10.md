# PFDS 10.1.1 多相再帰
![background](debian.png)

Kiwamu Okabe

# 多相再帰って何？

再帰を一つ進める前と後とで型が異なること。

xxx コード例 xxx

# SMLで書きたい...んだけど

PFDSによるとStandard MLでは...

* 多相的なデータ型を定義することは可能
* 多相再帰を書くことは不可能

SML# や SML/NJ はどーなのか気になりますね。
(すいません試してないです)

# 多相再帰=>単相再帰


# それなら全部単相再帰で書くべき？

# OCamlだと

~~~ {.ocaml}
type 'a my_seq = Nil | Cons of 'a * ('a * 'a) my_seq

let rec sizeS : 'a. 'a my_seq -> int = function
  | Nil -> 0
  | Cons (_, my_seq) -> 1 + 2 * sizeS my_seq
~~~

OCaml 3.12.0 以降であれば、型宣言書くだけでOK。

# Haskellだと

~~~ {.haskell}
data MySeq a = MSNil | MSCons (a, MySeq (a,a))

sizeS :: MySeq a -> Int
sizeS MSNil = 0
sizeS (MSCons (_, ps)) = 1 + 2 * sizeS ps
~~~

こちらも型宣言書けば問題ない。

# 再帰関数に型宣言付けるのがキモ

# 参考文献

~~~
* recursive module で polymorphic recursion を書く (camlspotter)
  http://d.hatena.ne.jp/camlspotter/20090408/1239172620
* 多相再帰 - λx.x K S K ＠ はてな
  http://d.hatena.ne.jp/KeisukeNakano/20060720/1153367670
* polymorphic recursion の話 - Hatena::Diary::pi8027
  http://d.hatena.ne.jp/pi8027/20101121/polymorphic_recursion
* 今日のスライドで使ったコード例
  https://github.com/master-q/readPurelyFunctionalDataStructures/tree/master/PolymorphicRecursion
~~~
