# Embedded application designed by ATS language
![background](img/back_title.png)

Kiwamu Okabe @ RIKEN AICS

# Remember Heartbleed bug?
![background](img/back.png)

Should we use safer language than C?

~~~
== In English ==
"Preventing heartbleed bugs with safe programming languages"
http://bluishcoder.co.nz/2014/04/11/preventing-heartbleed-bugs-with-safe-languages.html
== In Japanease ==
"安全なプログラミング言語を使って heartbleed を防ぐには"
https://github.com/jats-ug/translate/blob/master/Web/bluishcoder.co.nz/2014/04/11/preventing-heartbleed-bugs-with-safe-languages.md
~~~

"A safer systems programming language could have prevented the bug."

# Want the safer language... It's ATS!
![background](img/back.png)

* http://www.ats-lang.org/
* Syntax like ML
* DML-style dependent types
* Linear types
* Optional GC
* Optional malloc/free
* Optional run-time

# Agenda
![background](img/back.png)

* [1] Demo
* [2] ATS language basics
* [3] Proof on ATS
* [4] Linear type on ATS
* [XXX] Compare ATS to the other language
* [XXX] Conclusion

# [1] Demo: Embedded ATS application
![background](img/back.png)

https://github.com/fpiot/esp8266-ats

![inline](draw/demo_env.png)

# ESP8266 hardware
![background](img/back.png)

* http://espressif.com/en/products/wroom/
* 32-bit low power MCU Wi-Fi Module
* ROM: XXX byte / RAM: XXX byte
* Having integrated TCP/IP network stacks
* Including ADC, SDIO, UART, PWM, I2C ...
* Small form factor of only 18mm x 20mm

# What error can be captured by ATS?
![background](img/back.png)

```
$ vi user/user_main.dats
 39     val json_open = string0_copy "{\"value1\": \""
 40     val json_close = string0_copy "\" }"
 41     val temp = esp_tostrptr_int rand
 42     val json_head = strptr_append (json_open, temp)
 43     val json_data = strptr_append (json_head, json_close)
 44 //  val () = (free json_open; free json_close; free temp; free json_head)
 45     val () = (free json_open; free json_close; free temp) // Error!
$ make
ATS user/user_main.dats
/home/kiwamu/src/esp8266-ats/ifttt_ats/user/user_main.dats: 985(line=32, offs=43) -- 2237(line=55, offs=4): error(3): the linear dynamic variable [json_head$3823(-1)] needs to be consumed but it is preserved with the type [S2Eapp(S2Ecst(strptr_addr_vtype); S2EVar(4441))] instead.
patsopt(TRANS3): there are [1] errors in total.
```

# Compare to Event-B
# Compare to VeriFast
# Compare to Xmos
