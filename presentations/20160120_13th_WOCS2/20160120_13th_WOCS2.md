# Embedded application designed by ATS language

Kiwamu Okabe @ RIKEN AICS

# Demo: ATS application runs on ESP8266

https://github.com/fpiot/esp8266-ats

![inline](draw/demo_env.png)

# ESP8266 hardware
![background](img/ESP-WROOM-02.png)

* http://espressif.com/en/products/wroom/
* 32-bit low power MCU Wi-Fi Module
* Having integrated TCP/IP network stacks
* Including ADC, SDIO, UART, PWM, I2C ...
* Small form factor of only 18mm x 20mm

# What error can be captured by ATS?

```
$ vi user/user_main.dats
 39     val json_open = string0_copy "{\"value1\": \""
 40     val json_close = string0_copy "\" }"
 41     val temp = esp_tostrptr_int rand
 42     val json_head = strptr_append (json_open, temp)
 43     val json_data = strptr_append (json_head, json_close)
 44 //  val () = (free json_open; free json_close; free temp; free json_head)
 45     val () = (free json_open; free json_close; free temp) // Error!
$ make
ATS user/user_main.dats
/home/kiwamu/src/esp8266-ats/ifttt_ats/user/user_main.dats: 985(line=32, offs=43) -- 2237(line=55, offs=4): error(3): the linear dynamic variable [json_head$3823(-1)] needs to be consumed but it is preserved with the type [S2Eapp(S2Ecst(strptr_addr_vtype); S2EVar(4441))] instead.
patsopt(TRANS3): there are [1] errors in total.
```
