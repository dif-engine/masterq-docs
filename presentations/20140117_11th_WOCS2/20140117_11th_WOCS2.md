# How to rewrite the OS using C by strong type

Metasepi Project / Kiwamu Okabe

# Who am I?
![background](img/enjoy.png)

* http://www.masterq.net/
* Twitter: @master_q
* Organizer of Metasepi Project
* A developer of Ajhc Haskell compiler
* A Debian Maintainer
* 10 years' experience in developing OS using NetBSD.

# Agenda

* [1] Problems of OS using C
* [2] Type safety
* [3] Existing OS using strong type
* [4] Snatch-driven development
* [5] Demo
* [6] Case study of Snatch
* [7] Things not yet done

# [1] Problems of OS using C

# Buffer overrun

* Pointer to array doesn't know the length

xxx Figure

# Page fault in kernel

* Page fault in userspace => SEGV
* Page fault in kernelspace => Fault!

But debuging Fault is difficult.

xxx Figure

# Typecasting

* Great use of (void *) casting
* NetBSD kernel uses 45130 times!

~~~
$ pwd
/home/kiwamu/src/netbsd/sys
$ grep "void \*" `find . -name "*.c"` | wc -l
45130
~~~

# [2] Type safety
# [3] Existing OS using strong type
# [4] Snatch-driven development
# [5] Demo
# [6] Case study of Snatch
# [7] Things not yet done
